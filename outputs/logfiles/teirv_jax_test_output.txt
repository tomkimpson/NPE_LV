JAX TEIRV Simulator Test Suite
============================================================
============================================================
Testing GPU availability...
   Available devices: 1
     Device 0: Tesla P100-PCIE-12GB (gpu)
   🚀 GPU available: 1 GPU(s) detected
     GPU 0: cuda:0
   ⚠️  GPU memory test failed: 'Device' object is not callable
✅ GPU availability test completed
============================================================
Testing JAX TEIRV Simulator...
1. Setting up simulation parameters...
   Parameters: [ 10.605216  491.0657      7.672406    5.835181    0.7437396   7.9351134]
   Initial conditions: {'T': 80000000.0, 'E': 1.0, 'I': 0.0, 'R': 0.0, 'V': np.float32(7.9351134)}
   Time grid: 15 points from 0 to 14.0 days
2. Testing single simulation...
   Simulation completed in 324.861s
   Output shapes: times=(15,), states=(15, 5)
   Final state: T=8.0e+07, E=2412.0, I=799.0, R=659050.0, V=2.6e+04
3. Testing batch simulation...
slurmstepd: error: *** JOB 1265619 ON john1 CANCELLED AT 2025-06-17T18:31:21 DUE TO TIME LIMIT ***

+-------------------- Job Report: 1265619 (TIMEOUT) --------------------+
| Memory (RAM)  [###                 ] 16.9% (693.5 MB peak / 4 GB)     |
| CPU           [################### ] 97.7% average                    |
| GPU           [#############       ] 66.7% average                    |
| Time          [------------------->] 100.3% (0-00:10:02 / 0-00:10:00) |
|                                                                       |
| Lustre Filesystem:                                                    |
|   Path    Total Read    Total Write    Total IOPS                     |
|   ------  ------------  -------------  ------------                   |
|   /apps   0 B           0 B            7                              |
|   /fred   16 KB         1.7 KB         1.1 K                          |
|   /home   0 B           0 B            6                              |
|   OS      0 B           0 B            5                              |
|                                                                       |
| Warnings:                                                             |
|   - Too much memory requested                                         |
|   - GPU usage is low (possibly CPU-bound)                             |
+-----------------------------------------------------------------------+
