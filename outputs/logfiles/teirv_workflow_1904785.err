Generating TEIRV data:   0%|          | 0/50 [00:00<?, ?batch/s]Generating TEIRV data:   2%|▏         | 1/50 [06:16<5:07:42, 376.79s/batch]Generating TEIRV data:   2%|▏         | 1/50 [06:16<5:07:42, 376.79s/batch, valid=1000/1000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:   4%|▍         | 2/50 [12:33<5:01:28, 376.85s/batch, valid=1000/1000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:   4%|▍         | 2/50 [12:33<5:01:28, 376.85s/batch, valid=2000/2000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:   6%|▌         | 3/50 [18:50<4:55:02, 376.64s/batch, valid=2000/2000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:   6%|▌         | 3/50 [18:50<4:55:02, 376.64s/batch, valid=3000/3000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:   8%|▊         | 4/50 [24:59<4:46:30, 373.71s/batch, valid=3000/3000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:   8%|▊         | 4/50 [24:59<4:46:30, 373.71s/batch, valid=4000/4000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  10%|█         | 5/50 [31:22<4:42:49, 377.11s/batch, valid=4000/4000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  10%|█         | 5/50 [31:22<4:42:49, 377.11s/batch, valid=5000/5000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  12%|█▏        | 6/50 [38:11<4:44:24, 387.83s/batch, valid=5000/5000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  12%|█▏        | 6/50 [38:11<4:44:24, 387.83s/batch, valid=6000/6000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  14%|█▍        | 7/50 [45:09<4:45:03, 397.74s/batch, valid=6000/6000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  14%|█▍        | 7/50 [45:09<4:45:03, 397.74s/batch, valid=7000/7000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  16%|█▌        | 8/50 [52:01<4:41:32, 402.21s/batch, valid=7000/7000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  16%|█▌        | 8/50 [52:01<4:41:32, 402.21s/batch, valid=8000/8000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  18%|█▊        | 9/50 [59:03<4:39:11, 408.58s/batch, valid=8000/8000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  18%|█▊        | 9/50 [59:03<4:39:11, 408.58s/batch, valid=9000/9000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  20%|██        | 10/50 [1:05:27<4:27:20, 401.02s/batch, valid=9000/9000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  20%|██        | 10/50 [1:05:27<4:27:20, 401.02s/batch, valid=10000/10000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  22%|██▏       | 11/50 [1:11:52<4:17:28, 396.12s/batch, valid=10000/10000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  22%|██▏       | 11/50 [1:11:52<4:17:28, 396.12s/batch, valid=11000/11000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  24%|██▍       | 12/50 [1:18:03<4:05:56, 388.33s/batch, valid=11000/11000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  24%|██▍       | 12/50 [1:18:03<4:05:56, 388.33s/batch, valid=12000/12000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  26%|██▌       | 13/50 [1:24:21<3:57:37, 385.35s/batch, valid=12000/12000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  26%|██▌       | 13/50 [1:24:21<3:57:37, 385.35s/batch, valid=13000/13000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  28%|██▊       | 14/50 [1:30:45<3:50:58, 384.95s/batch, valid=13000/13000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  28%|██▊       | 14/50 [1:30:45<3:50:58, 384.95s/batch, valid=14000/14000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  30%|███       | 15/50 [1:37:02<3:43:03, 382.40s/batch, valid=14000/14000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  30%|███       | 15/50 [1:37:02<3:43:03, 382.40s/batch, valid=15000/15000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  32%|███▏      | 16/50 [1:43:09<3:34:12, 378.00s/batch, valid=15000/15000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  32%|███▏      | 16/50 [1:43:10<3:34:12, 378.00s/batch, valid=16000/16000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  34%|███▍      | 17/50 [1:49:24<3:27:19, 376.95s/batch, valid=16000/16000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  34%|███▍      | 17/50 [1:49:24<3:27:19, 376.95s/batch, valid=17000/17000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  36%|███▌      | 18/50 [1:55:46<3:21:48, 378.40s/batch, valid=17000/17000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  36%|███▌      | 18/50 [1:55:46<3:21:48, 378.40s/batch, valid=18000/18000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  38%|███▊      | 19/50 [2:02:08<3:16:09, 379.67s/batch, valid=18000/18000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  38%|███▊      | 19/50 [2:02:08<3:16:09, 379.67s/batch, valid=19000/19000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  40%|████      | 20/50 [2:08:22<3:08:59, 378.00s/batch, valid=19000/19000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  40%|████      | 20/50 [2:08:22<3:08:59, 378.00s/batch, valid=20000/20000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  42%|████▏     | 21/50 [2:14:48<3:03:44, 380.14s/batch, valid=20000/20000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  42%|████▏     | 21/50 [2:14:48<3:03:44, 380.14s/batch, valid=21000/21000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  44%|████▍     | 22/50 [2:21:06<2:57:08, 379.59s/batch, valid=21000/21000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  44%|████▍     | 22/50 [2:21:06<2:57:08, 379.59s/batch, valid=22000/22000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  46%|████▌     | 23/50 [2:27:19<2:49:54, 377.56s/batch, valid=22000/22000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  46%|████▌     | 23/50 [2:27:19<2:49:54, 377.56s/batch, valid=23000/23000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  48%|████▊     | 24/50 [2:33:29<2:42:41, 375.45s/batch, valid=23000/23000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  48%|████▊     | 24/50 [2:33:29<2:42:41, 375.45s/batch, valid=24000/24000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  50%|█████     | 25/50 [2:39:31<2:34:41, 371.26s/batch, valid=24000/24000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  50%|█████     | 25/50 [2:39:31<2:34:41, 371.26s/batch, valid=25000/25000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  52%|█████▏    | 26/50 [2:45:56<2:30:12, 375.54s/batch, valid=25000/25000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  52%|█████▏    | 26/50 [2:45:56<2:30:12, 375.54s/batch, valid=26000/26000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  54%|█████▍    | 27/50 [2:52:16<2:24:27, 376.84s/batch, valid=26000/26000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  54%|█████▍    | 27/50 [2:52:16<2:24:27, 376.84s/batch, valid=27000/27000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  56%|█████▌    | 28/50 [2:58:36<2:18:31, 377.78s/batch, valid=27000/27000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  56%|█████▌    | 28/50 [2:58:36<2:18:31, 377.78s/batch, valid=28000/28000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  58%|█████▊    | 29/50 [3:04:57<2:12:32, 378.68s/batch, valid=28000/28000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  58%|█████▊    | 29/50 [3:04:57<2:12:32, 378.68s/batch, valid=29000/29000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  60%|██████    | 30/50 [3:11:18<2:06:29, 379.48s/batch, valid=29000/29000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  60%|██████    | 30/50 [3:11:18<2:06:29, 379.48s/batch, valid=30000/30000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  62%|██████▏   | 31/50 [3:17:34<1:59:48, 378.36s/batch, valid=30000/30000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  62%|██████▏   | 31/50 [3:17:34<1:59:48, 378.36s/batch, valid=31000/31000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  64%|██████▍   | 32/50 [3:23:50<1:53:19, 377.74s/batch, valid=31000/31000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  64%|██████▍   | 32/50 [3:23:50<1:53:19, 377.74s/batch, valid=32000/32000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  66%|██████▌   | 33/50 [3:30:16<1:47:40, 380.02s/batch, valid=32000/32000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  66%|██████▌   | 33/50 [3:30:16<1:47:40, 380.02s/batch, valid=33000/33000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  68%|██████▊   | 34/50 [3:36:24<1:40:22, 376.43s/batch, valid=33000/33000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  68%|██████▊   | 34/50 [3:36:24<1:40:22, 376.43s/batch, valid=34000/34000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  70%|███████   | 35/50 [3:42:33<1:33:35, 374.36s/batch, valid=34000/34000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  70%|███████   | 35/50 [3:42:33<1:33:35, 374.36s/batch, valid=35000/35000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  72%|███████▏  | 36/50 [3:48:47<1:27:20, 374.31s/batch, valid=35000/35000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  72%|███████▏  | 36/50 [3:48:47<1:27:20, 374.31s/batch, valid=36000/36000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  74%|███████▍  | 37/50 [3:54:59<1:20:55, 373.47s/batch, valid=36000/36000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  74%|███████▍  | 37/50 [3:54:59<1:20:55, 373.47s/batch, valid=37000/37000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  76%|███████▌  | 38/50 [4:01:12<1:14:38, 373.21s/batch, valid=37000/37000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  76%|███████▌  | 38/50 [4:01:12<1:14:38, 373.21s/batch, valid=38000/38000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  78%|███████▊  | 39/50 [4:07:20<1:08:10, 371.90s/batch, valid=38000/38000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  78%|███████▊  | 39/50 [4:07:20<1:08:10, 371.90s/batch, valid=39000/39000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  80%|████████  | 40/50 [4:13:33<1:01:59, 371.99s/batch, valid=39000/39000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  80%|████████  | 40/50 [4:13:33<1:01:59, 371.99s/batch, valid=40000/40000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  82%|████████▏ | 41/50 [4:19:47<55:55, 372.86s/batch, valid=40000/40000, batch_valid=1000/1000, rate=100.0%]  Generating TEIRV data:  82%|████████▏ | 41/50 [4:19:47<55:55, 372.86s/batch, valid=41000/41000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  84%|████████▍ | 42/50 [4:25:59<49:40, 372.55s/batch, valid=41000/41000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  84%|████████▍ | 42/50 [4:25:59<49:40, 372.55s/batch, valid=42000/42000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  86%|████████▌ | 43/50 [4:32:07<43:16, 370.97s/batch, valid=42000/42000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  86%|████████▌ | 43/50 [4:32:07<43:16, 370.97s/batch, valid=43000/43000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  88%|████████▊ | 44/50 [4:38:47<37:59, 379.94s/batch, valid=43000/43000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  88%|████████▊ | 44/50 [4:38:47<37:59, 379.94s/batch, valid=44000/44000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  90%|█████████ | 45/50 [4:44:59<31:26, 377.30s/batch, valid=44000/44000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  90%|█████████ | 45/50 [4:44:59<31:26, 377.30s/batch, valid=45000/45000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  92%|█████████▏| 46/50 [4:51:03<24:53, 373.31s/batch, valid=45000/45000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  92%|█████████▏| 46/50 [4:51:03<24:53, 373.31s/batch, valid=46000/46000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  94%|█████████▍| 47/50 [4:57:21<18:44, 374.78s/batch, valid=46000/46000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  94%|█████████▍| 47/50 [4:57:21<18:44, 374.78s/batch, valid=47000/47000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  96%|█████████▌| 48/50 [5:03:41<12:32, 376.39s/batch, valid=47000/47000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  96%|█████████▌| 48/50 [5:03:41<12:32, 376.39s/batch, valid=48000/48000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  98%|█████████▊| 49/50 [5:10:01<06:17, 377.47s/batch, valid=48000/48000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  98%|█████████▊| 49/50 [5:10:01<06:17, 377.47s/batch, valid=49000/49000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data: 100%|██████████| 50/50 [5:16:08<00:00, 374.36s/batch, valid=49000/49000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data: 100%|██████████| 50/50 [5:16:08<00:00, 374.36s/batch, valid=50000/50000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data: 100%|██████████| 50/50 [5:16:08<00:00, 379.37s/batch, valid=50000/50000, batch_valid=1000/1000, rate=100.0%]
Traceback (most recent call last):
  File "/fred/oz022/tkimpson/NPE_LV/scripts/TEIRV_workflow.py", line 819, in <module>
    main()
  File "/fred/oz022/tkimpson/NPE_LV/scripts/TEIRV_workflow.py", line 812, in main
    workflow.full_pipeline(args)
  File "/fred/oz022/tkimpson/NPE_LV/scripts/TEIRV_workflow.py", line 684, in full_pipeline
    model_path = self.train_model(train_args)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/fred/oz022/tkimpson/NPE_LV/scripts/TEIRV_workflow.py", line 175, in train_model
    inference.setup_inference(
  File "/fred/oz022/tkimpson/NPE_LV/src/TEIRV/teirv_inference.py", line 74, in setup_inference
    self.inference = SNPE(
                     ^^^^^
  File "/fred/oz022/tkimpson/conda_envs/NPE_LV/lib/python3.11/site-packages/sbi/inference/trainers/npe/npe_c.py", line 93, in __init__
    super().__init__(**kwargs)
  File "/fred/oz022/tkimpson/conda_envs/NPE_LV/lib/python3.11/site-packages/sbi/inference/trainers/npe/npe_base.py", line 77, in __init__
    super().__init__(
  File "/fred/oz022/tkimpson/conda_envs/NPE_LV/lib/python3.11/site-packages/sbi/inference/trainers/base.py", line 156, in __init__
    check_if_prior_on_device(self._device, prior)
  File "/fred/oz022/tkimpson/conda_envs/NPE_LV/lib/python3.11/site-packages/sbi/utils/torchutils.py", line 96, in check_if_prior_on_device
    assert prior_device == training_device, (
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: Prior device 'cpu' must match training device 'cuda:0'. When training on GPU make sure to pass a prior initialized on the GPU as well, e.g., prior = torch.distributions.Normal(torch.zeros(2, device='cuda'), scale=1.0)`.

real	320m25.162s
user	308m52.412s
sys	5m26.997s
