==========================================
TEIRV NPE Full Workflow
==========================================
Job ID: 1904785
Node: gina304
Start time: Mon Jun 30 15:12:25 AEST 2025
Workflow name: production_run_20250630_151225
Training samples: 50000
Device: cuda
Max epochs: 200
==========================================
Checking CUDA availability...
CUDA available: True
CUDA devices: 1
NVIDIA GPU info:
Mon Jun 30 15:13:55 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.148.08             Driver Version: 570.148.08     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:01:00.0 Off |                    0 |
| N/A   32C    P0             67W /  500W |       0MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
==========================================
Starting TEIRV workflow at Mon Jun 30 15:13:55 AEST 2025
🚀 TEIRV NPE Complete Pipeline
==================================================
📁 Workflow directory: workflows/production_run_20250630_151225
📊 Training samples: 50000
🔧 Device: cuda

🔬 Step 1: Generating training data...
🔬 TEIRV Training Data Generation
==================================================
Samples: 50000
Simulation timespan: [0, 14.0] days
Observation grid: 15 points at 1.0-day intervals
Observation type: RT-PCR only
RT-PCR noise: 1.0
Detection limit: -0.65
Output: workflows/production_run_20250630_151225/training_data.pkl

TEIRV Parameter Priors:
------------------------------
  β (infection rate):       Uniform(0.0, 20.0)
  π (virion production):    Uniform(200.0, 600.0)
  δ (cell clearance):       Uniform(1.0, 11.0)
  φ (interferon protection): Uniform(0.0, 15.0)
  ρ (reversion rate):       Uniform(0.0, 1.0)
  V₀ (initial virions):     exp(Uniform(0.0, 5.0)) ≈ [1, 148]

Starting data generation...
Generated 50000/50000 valid samples (0 failed)
Saved TEIRV data to workflows/production_run_20250630_151225/training_data.pkl
Data shapes: theta=torch.Size([50000, 6]), x=torch.Size([50000, 15])

✅ DATA GENERATION COMPLETED
⏱️  Generation time: 18970.0 seconds
📊 Generated 50000 valid samples
⚡ Generation rate: 2.6 samples/second

🧠 Step 2: Training NPE model...
🧠 TEIRV NPE Model Training
==================================================
Data: workflows/production_run_20250630_151225/training_data.pkl
Output: workflows/production_run_20250630_151225/npe_model.pkl
Device: cuda

✅ Loaded 50000 training samples
Parameter shape: torch.Size([50000, 6])
Observation shape: torch.Size([50000, 15])
Observation type: rt_pcr
==========================================
Workflow completed at Mon Jun 30 20:34:21 AEST 2025
Exit code: 1
❌ WORKFLOW FAILED with exit code 1
Check the log files for details:
  - Standard output: outputs/logfiles/teirv_workflow_1904785.out
  - Standard error: outputs/logfiles/teirv_workflow_1904785.err
==========================================

+------------------ Job Report: 1904785 (COMPLETED) -------------------+
| Memory (RAM)  [                    ]  2.7% (443.8 MB peak / 16 GB)   |
| CPU           [####                ] 23.9% average                   |
| GPU           [                    ]  0.1% average                   |
| Time          [---->               ] 22.4% (0-05:22:29 / 1-00:00:00) |
|                                                                      |
| Lustre Filesystem:                                                   |
|   Path    Total Read    Total Write    Total IOPS                    |
|   ------  ------------  -------------  ------------                  |
|   /apps   0 B           0 B            8                             |
|   /fred   542.4 MB      4.1 MB         21.5 K                        |
|   /home   27.4 MB       0 B            12                            |
|   OS      0 B           0 B            17                            |
|                                                                      |
| Warnings:                                                            |
|   - Too much memory requested                                        |
|   - CPU usage is low                                                 |
|   - GPU usage is low                                                 |
|   - Too much time requested                                          |
+----------------------------------------------------------------------+
