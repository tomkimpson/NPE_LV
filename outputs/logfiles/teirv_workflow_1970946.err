Generating TEIRV data:   0%|          | 0/50 [00:00<?, ?batch/s]Generating TEIRV data:   2%|▏         | 1/50 [06:08<5:00:43, 368.23s/batch]Generating TEIRV data:   2%|▏         | 1/50 [06:08<5:00:43, 368.23s/batch, valid=1000/1000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:   4%|▍         | 2/50 [12:18<4:55:34, 369.47s/batch, valid=1000/1000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:   4%|▍         | 2/50 [12:18<4:55:34, 369.47s/batch, valid=2000/2000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:   6%|▌         | 3/50 [18:32<4:51:04, 371.58s/batch, valid=2000/2000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:   6%|▌         | 3/50 [18:32<4:51:04, 371.58s/batch, valid=3000/3000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:   8%|▊         | 4/50 [24:37<4:42:56, 369.06s/batch, valid=3000/3000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:   8%|▊         | 4/50 [24:37<4:42:56, 369.06s/batch, valid=4000/4000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  10%|█         | 5/50 [30:55<4:39:14, 372.32s/batch, valid=4000/4000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  10%|█         | 5/50 [30:55<4:39:14, 372.32s/batch, valid=5000/5000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  12%|█▏        | 6/50 [37:12<4:34:02, 373.68s/batch, valid=5000/5000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  12%|█▏        | 6/50 [37:12<4:34:02, 373.68s/batch, valid=6000/6000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  14%|█▍        | 7/50 [43:35<4:29:55, 376.64s/batch, valid=6000/6000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  14%|█▍        | 7/50 [43:35<4:29:55, 376.64s/batch, valid=7000/7000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  16%|█▌        | 8/50 [49:52<4:23:46, 376.81s/batch, valid=7000/7000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  16%|█▌        | 8/50 [49:52<4:23:46, 376.81s/batch, valid=8000/8000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  18%|█▊        | 9/50 [56:16<4:19:06, 379.19s/batch, valid=8000/8000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  18%|█▊        | 9/50 [56:16<4:19:06, 379.19s/batch, valid=9000/9000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  20%|██        | 10/50 [1:02:46<4:15:03, 382.58s/batch, valid=9000/9000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  20%|██        | 10/50 [1:02:46<4:15:03, 382.58s/batch, valid=10000/10000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  22%|██▏       | 11/50 [1:09:19<4:10:46, 385.80s/batch, valid=10000/10000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  22%|██▏       | 11/50 [1:09:19<4:10:46, 385.80s/batch, valid=11000/11000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  24%|██▍       | 12/50 [1:15:37<4:02:48, 383.39s/batch, valid=11000/11000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  24%|██▍       | 12/50 [1:15:37<4:02:48, 383.39s/batch, valid=12000/12000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  26%|██▌       | 13/50 [1:21:58<3:55:52, 382.50s/batch, valid=12000/12000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  26%|██▌       | 13/50 [1:21:58<3:55:52, 382.50s/batch, valid=13000/13000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  28%|██▊       | 14/50 [1:28:28<3:50:56, 384.91s/batch, valid=13000/13000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  28%|██▊       | 14/50 [1:28:28<3:50:56, 384.91s/batch, valid=14000/14000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  30%|███       | 15/50 [1:34:45<3:43:10, 382.59s/batch, valid=14000/14000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  30%|███       | 15/50 [1:34:45<3:43:10, 382.59s/batch, valid=15000/15000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  32%|███▏      | 16/50 [1:40:57<3:34:50, 379.14s/batch, valid=15000/15000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  32%|███▏      | 16/50 [1:40:57<3:34:50, 379.14s/batch, valid=16000/16000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  34%|███▍      | 17/50 [1:47:12<3:27:56, 378.09s/batch, valid=16000/16000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  34%|███▍      | 17/50 [1:47:12<3:27:56, 378.09s/batch, valid=17000/17000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  36%|███▌      | 18/50 [1:53:38<3:22:52, 380.39s/batch, valid=17000/17000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  36%|███▌      | 18/50 [1:53:38<3:22:52, 380.39s/batch, valid=18000/18000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  38%|███▊      | 19/50 [1:59:58<3:16:24, 380.15s/batch, valid=18000/18000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  38%|███▊      | 19/50 [1:59:58<3:16:24, 380.15s/batch, valid=19000/19000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  40%|████      | 20/50 [2:06:20<3:10:21, 380.73s/batch, valid=19000/19000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  40%|████      | 20/50 [2:06:20<3:10:21, 380.73s/batch, valid=20000/20000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  42%|████▏     | 21/50 [2:12:39<3:03:50, 380.35s/batch, valid=20000/20000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  42%|████▏     | 21/50 [2:12:39<3:03:50, 380.35s/batch, valid=21000/21000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  44%|████▍     | 22/50 [2:18:57<2:57:09, 379.61s/batch, valid=21000/21000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  44%|████▍     | 22/50 [2:18:57<2:57:09, 379.61s/batch, valid=22000/22000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  46%|████▌     | 23/50 [2:25:07<2:49:29, 376.63s/batch, valid=22000/22000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  46%|████▌     | 23/50 [2:25:07<2:49:29, 376.63s/batch, valid=23000/23000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  48%|████▊     | 24/50 [2:31:16<2:42:18, 374.57s/batch, valid=23000/23000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  48%|████▊     | 24/50 [2:31:16<2:42:18, 374.57s/batch, valid=24000/24000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  50%|█████     | 25/50 [2:37:27<2:35:33, 373.35s/batch, valid=24000/24000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  50%|█████     | 25/50 [2:37:27<2:35:33, 373.35s/batch, valid=25000/25000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  52%|█████▏    | 26/50 [2:43:49<2:30:24, 376.03s/batch, valid=25000/25000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  52%|█████▏    | 26/50 [2:43:49<2:30:24, 376.03s/batch, valid=26000/26000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  54%|█████▍    | 27/50 [2:50:12<2:24:58, 378.21s/batch, valid=26000/26000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  54%|█████▍    | 27/50 [2:50:12<2:24:58, 378.21s/batch, valid=27000/27000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  56%|█████▌    | 28/50 [2:56:34<2:19:03, 379.23s/batch, valid=27000/27000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  56%|█████▌    | 28/50 [2:56:34<2:19:03, 379.23s/batch, valid=28000/28000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  58%|█████▊    | 29/50 [3:02:58<2:13:11, 380.56s/batch, valid=28000/28000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  58%|█████▊    | 29/50 [3:02:58<2:13:11, 380.56s/batch, valid=29000/29000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  60%|██████    | 30/50 [3:09:23<2:07:18, 381.94s/batch, valid=29000/29000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  60%|██████    | 30/50 [3:09:23<2:07:18, 381.94s/batch, valid=30000/30000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  62%|██████▏   | 31/50 [3:15:41<2:00:36, 380.88s/batch, valid=30000/30000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  62%|██████▏   | 31/50 [3:15:41<2:00:36, 380.88s/batch, valid=31000/31000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  64%|██████▍   | 32/50 [3:22:01<1:54:07, 380.43s/batch, valid=31000/31000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  64%|██████▍   | 32/50 [3:22:01<1:54:07, 380.43s/batch, valid=32000/32000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  66%|██████▌   | 33/50 [3:28:26<1:48:10, 381.81s/batch, valid=32000/32000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  66%|██████▌   | 33/50 [3:28:26<1:48:10, 381.81s/batch, valid=33000/33000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  68%|██████▊   | 34/50 [3:34:33<1:40:39, 377.49s/batch, valid=33000/33000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  68%|██████▊   | 34/50 [3:34:33<1:40:39, 377.49s/batch, valid=34000/34000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  70%|███████   | 35/50 [3:40:53<1:34:34, 378.32s/batch, valid=34000/34000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  70%|███████   | 35/50 [3:40:53<1:34:34, 378.32s/batch, valid=35000/35000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  72%|███████▏  | 36/50 [3:47:05<1:27:49, 376.42s/batch, valid=35000/35000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  72%|███████▏  | 36/50 [3:47:05<1:27:49, 376.42s/batch, valid=36000/36000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  74%|███████▍  | 37/50 [3:53:18<1:21:18, 375.27s/batch, valid=36000/36000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  74%|███████▍  | 37/50 [3:53:18<1:21:18, 375.27s/batch, valid=37000/37000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  76%|███████▌  | 38/50 [3:59:32<1:14:58, 374.85s/batch, valid=37000/37000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  76%|███████▌  | 38/50 [3:59:32<1:14:58, 374.85s/batch, valid=38000/38000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  78%|███████▊  | 39/50 [4:05:41<1:08:23, 373.02s/batch, valid=38000/38000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  78%|███████▊  | 39/50 [4:05:41<1:08:23, 373.02s/batch, valid=39000/39000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  80%|████████  | 40/50 [4:11:55<1:02:13, 373.36s/batch, valid=39000/39000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  80%|████████  | 40/50 [4:11:55<1:02:13, 373.36s/batch, valid=40000/40000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  82%|████████▏ | 41/50 [4:18:11<56:08, 374.24s/batch, valid=40000/40000, batch_valid=1000/1000, rate=100.0%]  Generating TEIRV data:  82%|████████▏ | 41/50 [4:18:11<56:08, 374.24s/batch, valid=41000/41000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  84%|████████▍ | 42/50 [4:24:22<49:46, 373.34s/batch, valid=41000/41000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  84%|████████▍ | 42/50 [4:24:22<49:46, 373.34s/batch, valid=42000/42000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  86%|████████▌ | 43/50 [4:30:26<43:12, 370.34s/batch, valid=42000/42000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  86%|████████▌ | 43/50 [4:30:26<43:12, 370.34s/batch, valid=43000/43000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  88%|████████▊ | 44/50 [4:36:45<37:18, 373.12s/batch, valid=43000/43000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  88%|████████▊ | 44/50 [4:36:45<37:18, 373.12s/batch, valid=44000/44000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  90%|█████████ | 45/50 [4:42:58<31:04, 372.95s/batch, valid=44000/44000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  90%|█████████ | 45/50 [4:42:58<31:04, 372.95s/batch, valid=45000/45000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  92%|█████████▏| 46/50 [4:49:04<24:44, 371.07s/batch, valid=45000/45000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  92%|█████████▏| 46/50 [4:49:04<24:44, 371.07s/batch, valid=46000/46000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  94%|█████████▍| 47/50 [4:55:21<18:37, 372.58s/batch, valid=46000/46000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  94%|█████████▍| 47/50 [4:55:21<18:37, 372.58s/batch, valid=47000/47000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  96%|█████████▌| 48/50 [5:01:47<12:33, 376.65s/batch, valid=47000/47000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  96%|█████████▌| 48/50 [5:01:47<12:33, 376.65s/batch, valid=48000/48000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  98%|█████████▊| 49/50 [5:08:08<06:17, 377.90s/batch, valid=48000/48000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data:  98%|█████████▊| 49/50 [5:08:08<06:17, 377.90s/batch, valid=49000/49000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data: 100%|██████████| 50/50 [5:14:17<00:00, 375.32s/batch, valid=49000/49000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data: 100%|██████████| 50/50 [5:14:17<00:00, 375.32s/batch, valid=50000/50000, batch_valid=1000/1000, rate=100.0%]Generating TEIRV data: 100%|██████████| 50/50 [5:14:17<00:00, 377.15s/batch, valid=50000/50000, batch_valid=1000/1000, rate=100.0%]
/fred/oz022/tkimpson/conda_envs/NPE_LV/lib/python3.11/site-packages/sbi/inference/trainers/npe/npe_base.py:158: UserWarning: Data x has device 'cpu'. Moving x to the data_device 'cuda'. Training will proceed on device 'cuda'.
  theta, x = validate_theta_and_x(
/fred/oz022/tkimpson/conda_envs/NPE_LV/lib/python3.11/site-packages/sbi/inference/trainers/npe/npe_base.py:158: UserWarning: Parameters theta has device 'cpu'. Moving theta to the data_device 'cuda'. Training will proceed on device 'cuda'.
  theta, x = validate_theta_and_x(
/fred/oz022/tkimpson/NPE_LV/src/TEIRV/teirv_inference.py:220: UserWarning: When the inference object is pickled, the behaviour of the loaded object changes in the following two ways: 1) `.train(..., retrain_from_scratch=True)` is not supported. 2) When the loaded object calls the `.train()` method, it generates a new tensorboard summary writer (instead of appending to the current one).
  pickle.dump(data, f)
Drawing 20000 posterior samples:   0%|          | 0/20000 [00:00<?, ?it/s]Drawing 20000 posterior samples:   0%|          | 0/20000 [00:04<?, ?it/s]
Drawing 20000 posterior samples:   0%|          | 0/20000 [00:00<?, ?it/s]Drawing 20000 posterior samples:   0%|          | 0/20000 [00:00<?, ?it/s]
Drawing 20000 posterior samples:   0%|          | 0/20000 [00:00<?, ?it/s]Drawing 20000 posterior samples:   0%|          | 0/20000 [00:00<?, ?it/s]
Drawing 20000 posterior samples:   0%|          | 0/20000 [00:00<?, ?it/s]Drawing 20000 posterior samples:   0%|          | 0/20000 [00:00<?, ?it/s]
Drawing 20000 posterior samples:   0%|          | 0/20000 [00:00<?, ?it/s]Drawing 20000 posterior samples:   0%|          | 0/20000 [00:00<?, ?it/s]
Drawing 20000 posterior samples:   0%|          | 0/20000 [00:00<?, ?it/s]Drawing 20000 posterior samples:   0%|          | 0/20000 [00:00<?, ?it/s]

real	325m21.548s
user	309m11.583s
sys	6m19.411s
