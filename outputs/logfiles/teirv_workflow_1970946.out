==========================================
TEIRV NPE Full Workflow
==========================================
Job ID: 1970946
Node: gina1
Start time: Thu Jul  3 12:30:40 AEST 2025
Workflow name: production_run_20250703_123040
Training samples: 50000
Device: cuda
Max epochs: 200
==========================================
Checking CUDA availability...
CUDA available: True
CUDA devices: 1
NVIDIA GPU info:
Thu Jul  3 12:32:08 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.148.08             Driver Version: 570.148.08     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:01:00.0 Off |                    0 |
| N/A   26C    P0             63W /  500W |       0MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
==========================================
Starting TEIRV workflow at Thu Jul  3 12:32:08 AEST 2025
üöÄ TEIRV NPE Complete Pipeline
==================================================
üìÅ Workflow directory: workflows/production_run_20250703_123040
üìä Training samples: 50000
üîß Device: cuda

üî¨ Step 1: Generating training data...
üî¨ TEIRV Training Data Generation
==================================================
Samples: 50000
Simulation timespan: [0, 14.0] days
Observation grid: 15 points at 1.0-day intervals
Observation type: RT-PCR only
RT-PCR noise: 1.0
Detection limit: -0.65
Output: workflows/production_run_20250703_123040/training_data.pkl

TEIRV Parameter Priors:
------------------------------
  Œ≤ (infection rate):       Uniform(0.0, 20.0)
  œÄ (virion production):    Uniform(200.0, 600.0)
  Œ¥ (cell clearance):       Uniform(1.0, 11.0)
  œÜ (interferon protection): Uniform(0.0, 15.0)
  œÅ (reversion rate):       Uniform(0.0, 1.0)
  V‚ÇÄ (initial virions):     exp(Uniform(0.0, 5.0)) ‚âà [1, 148]

Starting data generation...
Generated 50000/50000 valid samples (0 failed)
Saved TEIRV data to workflows/production_run_20250703_123040/training_data.pkl
Data shapes: theta=torch.Size([50000, 6]), x=torch.Size([50000, 15])

‚úÖ DATA GENERATION COMPLETED
‚è±Ô∏è  Generation time: 18858.1 seconds
üìä Generated 50000 valid samples
‚ö° Generation rate: 2.7 samples/second

üß† Step 2: Training NPE model...
üß† TEIRV NPE Model Training
==================================================
Data: workflows/production_run_20250703_123040/training_data.pkl
Output: workflows/production_run_20250703_123040/npe_model.pkl
Device: cuda

‚úÖ Loaded 50000 training samples
Parameter shape: torch.Size([50000, 6])
Observation shape: torch.Size([50000, 15])
Observation type: rt_pcr
Starting training...
Training TEIRV NPE with 50000 samples...
Parameter shape: torch.Size([50000, 6])
Observation shape: torch.Size([50000, 15])
Observation type: rt_pcr
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Training neural network. Epochs trained: 22 Training neural network. Epochs trained: 23 Training neural network. Epochs trained: 24 Training neural network. Epochs trained: 25 Training neural network. Epochs trained: 26 Training neural network. Epochs trained: 27 Training neural network. Epochs trained: 28 Training neural network. Epochs trained: 29 Training neural network. Epochs trained: 30 Training neural network. Epochs trained: 31 Training neural network. Epochs trained: 32 Training neural network. Epochs trained: 33 Training neural network. Epochs trained: 34 Training neural network. Epochs trained: 35 Training neural network. Epochs trained: 36 Training neural network. Epochs trained: 37 Training neural network. Epochs trained: 38 Neural network successfully converged after 38 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 38
        Best validation performance: 17.2066
        -------------------------
        
Saved TEIRV model to workflows/production_run_20250703_123040/npe_model.pkl

‚úÖ TRAINING COMPLETED
‚è±Ô∏è  Training time: 404.7 seconds
üìÅ Model saved to workflows/production_run_20250703_123040/npe_model.pkl

üè• Step 3: Running inference...
üè• TEIRV Inference
==================================================
Loading NPE model from workflows/production_run_20250703_123040/npe_model.pkl
Loaded TEIRV model from workflows/production_run_20250703_123040/npe_model.pkl
‚úÖ NPE model loaded successfully

Loading clinical data...
Found 6 patient datasets: ['443108', '445602', '444391', '444332', '432192', '451152']
Loaded patient 443108: 14 timepoints
Loaded patient 445602: 14 timepoints
Loaded patient 444391: 14 timepoints
Loaded patient 444332: 14 timepoints
Loaded patient 432192: 14 timepoints
Loaded patient 451152: 14 timepoints
‚úÖ Found 6 patients
Filtered 6/6 patients meeting criteria
‚úÖ Processing 6 patients
Prepared patient 443108: torch.Size([15])
Prepared patient 445602: torch.Size([15])
Prepared patient 444391: torch.Size([15])
Prepared patient 444332: torch.Size([15])
Prepared patient 432192: torch.Size([15])
Prepared patient 451152: torch.Size([15])

Performing NPE inference (20000 samples per patient)...

Processing patient 443108
  ‚ùå Failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!

Processing patient 445602
  ‚ùå Failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!

Processing patient 444391
  ‚ùå Failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!

Processing patient 444332
  ‚ùå Failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!

Processing patient 432192
  ‚ùå Failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!

Processing patient 451152
  ‚ùå Failed: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu!

‚úÖ CLINICAL INFERENCE COMPLETED
‚è±Ô∏è  Total time: 4.19 seconds
üìÅ Results saved to workflows/production_run_20250703_123040/inference_results

üéâ COMPLETE PIPELINE FINISHED
‚è±Ô∏è  Total time: 19275.9 seconds (321.3 minutes)
üìÅ All results in: workflows/production_run_20250703_123040
==========================================
Workflow completed at Thu Jul  3 17:57:30 AEST 2025
Exit code: 0
‚úÖ WORKFLOW COMPLETED SUCCESSFULLY
üìÅ Results available in: workflows/production_run_20250703_123040

Generated files:
  - workflows/production_run_20250703_123040/training_data.pkl
  - workflows/production_run_20250703_123040/npe_model.pkl
  - workflows/production_run_20250703_123040/inference_results/

To view results:
  ls -la workflows/production_run_20250703_123040/
  cat workflows/production_run_20250703_123040/inference_results/clinical_parameter_estimates.csv
==========================================
